	1. Number of users in the Control group 'A' 

SELECT  COUNT (g.group) No_of_Control
FROM groups g
INNER JOIN users u
ON g.uid=u.id
WHERE g.group='A'
24343


	2. Number of users in the Treatment group 'B'


SELECT  COUNT (g.group) No_of_treatment
FROM groups g
INNER JOIN users u
ON g.uid=u.id
WHERE g.group='B'
24600


	3. Total number of distinct users in the experiment i.e, in test groups A & B
	
	
SELECT  COUNT (DISTINCT g.uid) total_no_users
FROM groups g
INNER JOIN users u
ON g.uid=u.id
WHERE g.group IN ('A','B')
48943


	4. Total number of unique users in A & B who converted

SELECT  COUNT(DISTINCT a.uid) conversion, g.group test_group
FROM activity a
INNER JOIN groups g
ON a.uid=g.uid
GROUP BY g.group
HAVING g.group IN ('A','B')
955:A, 1139:B



	5. Number of Unique users in the control group 'A' who converted

SELECT  COUNT(DISTINCT a.uid) control_conversions
FROM activity a
INNER JOIN groups g
ON a.uid=g.uid
GROUP BY g.group
HAVING g.group='A'
955




	6. Number of Unique users in the treatment group 'B' who converted

SELECT  COUNT(DISTINCT a.uid) trtment_conversions
FROM activity a
INNER JOIN groups g
ON a.uid=g.uid
GROUP BY g.group
HAVING g.group = 'B'
1139


	7. Average amount spent per control user A including the unconverted

SELECT   SUM(a.spent)/24343 avg_amt_spent_control
FROM groups g
INNER JOIN users u
ON g.uid=u.id
FULL JOIN activity a
ON u.id=a.uid
WHERE g.group='A'
ORDER BY AVG(a.spent)
$3.375


	8. Average amount spent per treatment user B including the unconverted

SELECT SUM(a.spent)/24600 avg_amt_spent_treatment
FROM groups g
INNER JOIN users u
ON g.uid=u.id
FULL JOIN activity a
ON u.id=a.uid
WHERE g.group='B'
ORDER BY AVG(a.spent)
$3.391



	9. Average amount spent per user in the treatment group (coalesced)
 SELECT COALESCE (AVG(a.spent),0) avg_amt_spent_Treatment, u.id
FROM groups g
INNER JOIN users u
ON g.uid=u.id
LEFT JOIN activity a
ON u.id=a.uid
WHERE g.group='B'
GROUP BY 2
ORDER BY AVG (a.spent)


	10. Average amount spent per user in the control group (Coalesced)
	 
	SELECT COALESCE (AVG(a.spent),0) avg_amt_spent_Control, u.id
	FROM groups g
	INNER JOIN users u
	ON g.uid=u.id
	LEFT JOIN activity a
	ON u.id=a.uid
	WHERE g.group='A'
	GROUP BY 2
	ORDER BY AVG (a.spent)


	12. Write a SQL query that returns: the user ID, the user’s country, the user’s gender, the user’s device type, the user’s test group, whether or not they converted (spent > $0), and how much they spent in total ($0+)
	
	SELECT g.id user_id,
	       u.country  country,
	       u.gender  gender,
	       g.device  device,
	       g.group test_group,
		   CASE WHEN a.spent>0 THEN 1
		   ELSE 0
		   END conversion
	       COALESCE (SUM(a.spent),0)  amt_spent
	      
	FROM groups g
	JOIN users u
	ON g.uid=u.id
	LEFT JOIN activity a
	ON u.id=a.uid
	GROUP BY 1,2,3,4,5,6
	
	
